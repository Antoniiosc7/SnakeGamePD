{-# LANGUAGE OverloadedStrings #-}
import CodeWorld
import System.Random
import System.IO.Unsafe
import PintaFunciones

type Punto = (Int, Int)
type BloqueInter = (Punto, Punto, Punto, Punto, Punto)

type Estado = (Int, Int, Int, Int, [Punto], BloqueInter, [Punto], [Punto],[Punto], Int, [Punto])

{-
1 y 2: Tamaño del tablero
3 y 4: Int:  Bloque random donde esta la manzana
5: [Punto]: Los bloques donde está situada la serpiente en cada momento
6: Bloque Inter: Los bloques aleatorios donde se situan los obstaculos intermedios
7: [Punto]: Los bloques que forman la zona jugable
8: [Punto]: Los bloques que forman la zona en la que pierdes
9: [Punto]: Marcador
10: Veces que has ganado
11: Los puntos que te encierran si ganas.
-}

juego :: Int -> Int -> Int -> Int -> IO()
juego n m i j = activityOf (estadoBase n m i j) manejaEvento pintaEstadoConFondo


numRandom1 = (unsafePerformIO((randomRIO(-4, 4))::IO Int))
numRandom2 = (unsafePerformIO((randomRIO(0, -4))::IO Int))
main = juego 20 20 i j
  where i = numRandom1
        j = numRandom2

estadoBase n m i j= (n, m, i, j, serpiente, (((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), murosPuntos, carcelPuntos, marcador, 0, carcelGanadora) 
--type Estado = (Int, Int, Int, Int, Serpiente, BloqueInter, Bordes, Pierdes)
--Punto de perdida -10 0
serpiente = [(-4, 5), (-4, 5), (-4, 5), (-4, 5)]
carcelPuntos = [(-11,0), (-9, 0), (-11,1), (-11,-1), (-9,1), (-9,-1), (-10,1),(-10,-1)]
murosPuntos' = [(-5,-5),(-5,-4),(-5,-3),(-5,-2),(-5,-1),(-5,0),(-5,1),(-5,2),(-5,3),(-5,4),(-5,5),(-5,6),(6,-5),(6,-4),(6,-3),(6,-2),(6,-1),(6,0),(6,1),(6,2),(6,3),(6,4),(6,5),(6,6),(-5,-5),(-4,-5),(-3,-5),(-2,-5),(-1,-5),(0,-5),(1,-5),(2,-5),(3,-5),(4,-5),(5,-5),(6,-5),(6,6),(5,6),(4,6),(3,6),(2,6),(1,6),(0,6),(-1,6),(-2,6),(-3,6),(-4,6),(-5,6)]
murosPuntos = [(i,j) | (i,j) <- zip (repiteNumero (-5) (length cs)) cs] ++ [(i,j) | (i,j) <- zip (repiteNumero 6 (length cs)) cs] ++ [(i,j) | (i,j) <- zip cs (repiteNumero (-5) (length cs))] ++ [(i,j) | (i,j) <- zip cs (repiteNumero 6 (length cs))]
  where cs = [-5..6]
        zs = [6..(-5)]
repiteNumero :: Int -> Int -> [Int]
repiteNumero x 0 = []
repiteNumero x n = [x] ++ repiteNumero x (n-1)

marcador = [(-4,8),(-3,8),(-2,8),(-1,8),(0,8),(1,8),(2,8),(3,8),(4,8),(5,8)]
carcelGanadora' = [(12,0), (10, 0), (12,1), (12,-1), (10,1), (10,-1), (11,1),(11,-1)]
carcelGanadora :: [(Int, Int)]
carcelGanadora = filter (/= (11, 0)) $ concatMap (\f -> map f pares) [id, incrementar, decrementar]
  where
    pares = [(12, 0), (10, 0), (11, 0)]
    incrementar (x, y) = (x, y + 1)
    decrementar (x, y) = (x, y - 1)
    
{-
estructura de las guardas:
1º Pierdes porque tocas bloque intermedio
2º Has perdido e intentas salir de la carcel
3º Pierdes porque tocas muro
4º Intentas escapar del sitio de ganador
5º Has ganado 10 veces y te manda a sitio de ganador
6º Te comes la manzana
7º No hay ninguna acción, simplemente mueve serpiente
--}

manejaEvento :: Event -> Estado -> Estado 

manejaEvento (KeyPress "Right") (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2),(d1, d2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | (a1+1, a2) == (e1,e2) || (a1+1, a2) == (f1,f2) || (a1+1, a2) == (g1,g2) || (a1+1, a2) == (h1,h2) || (a1+1, a2) == (i1,i2) = pierdes
  | (a1+1, a2) == (l1,l2) || (a1+1, a2) == (l3,l4) || (a1+1, a2) == (l13,l14) || (a1+1, a2) == (l15,l16) = pierdes
  | (a1+1, a2) == (r1,r2) || (a1+1, a2) == (r3,r4) || (a1+1, a2) == (r5,r6) || (a1+1, a2) == (r7,r8) || (a1+1, a2) == (r9,r10) || (a1+1, a2) == (r11,r12) || (a1+1, a2) == (r13,r14) || (a1+1, a2) == (r15,r16) || (a1+1, a2) == (r17,r18) || (a1+1, a2) == (r19,r20) || (a1+1, a2) == (r21,r22) || (a1+1, a2) == (r23,r24) || (a1+1, a2) == (r25,r26) || (a1+1, a2) == (r27,r28) || (a1+1, a2) == (r29,r30) || (a1+1, a2) == (r31,r32) || (a1+1, a2) == (r33,r34) || (a1+1, a2) == (r35,r36) || (a1+1, a2) == (r37,r38) || (a1+1, a2) == (r39,r40) || (a1+1, a2) == (r41,r42) || (a1+1, a2) == (r43,r44) || (a1+1, a2) == (r45,r46) || (a1+1, a2) == (r47,r48) || (a1+1, a2) == (r49,r50) || (a1+1, a2) == (r51,r52) || (a1+1, a2) == (r53,r54) || (a1+1, a2) == (r55,r56) || (a1+1, a2) == (r57,r58) || (a1+1, a2) == (r59,r60) || (a1+1, a2) == (r61,r62) || (a1+1, a2) == (r63,r64) || (a1+1, a2) == (r65,r66) || (a1+1, a2) == (r67,r68) || (a1+1, a2) == (r69,r70) || (a1+1, a2) == (r71,r72) || (a1+1, a2) == (r73,r74) || (a1+1, a2) == (r75,r76) || (a1+1, a2) == (r77,r78) || (a1+1, a2) == (r79,r80) || (a1+1, a2) == (r81,r82) || (a1+1, a2) == (r83,r84) || (a1+1, a2) == (r85,r86) || (a1+1, a2) == (r87,r88) || (a1+1, a2) == (r89,r90) || (a1+1, a2) == (r91,r92) || (a1+1, a2) == (r93,r94) || (a1+1, a2) == (r95,r96) = pierdes 
  | (a1+1, a2) == (w1,w2) || (a1+1, a2) == (w3,w4) || (a1+1, a2) == (w13,w14) || (a1+1, a2) == (w15,w16) = prisionDeOro
  | ((a1+1, a2) == (i,j)) && (contador == 10) = prisionDeOro 
  | ((a1+1, a2) == (i,j)) && (contador < 10) = (n,m,(unsafePerformIO((randomRIO(-4, 4))::IO Int)),(unsafePerformIO((randomRIO(0, -4))::IO Int)),[(-4,5),(-4,5),(-4,5),(-4,5)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador+1, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | otherwise = (n,m,i,j,[(a1+1, a2),(a1, a2), (b1, b2), (c1, c2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  where
    pierdes = (n,m,0,0,[(-10, 0),(-10, 0), (-10, 0), (-10, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    prisionDeOro = (n,m,0,0,[(11, 0),(11, 0), (11, 0), (11, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])

manejaEvento (KeyPress "Left") (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2),(d1, d2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | (a1-1, a2) == (e1,e2) || (a1-1, a2) == (f1,f2) || (a1-1, a2) == (g1,g2) || (a1-1, a2) == (h1,h2) || (a1-1, a2) == (i1,i2) = pierdes
  | (a1-1, a2) == (l1,l2) || (a1-1, a2) == (l3,l4) || (a1-1, a2) == (l13,l14) || (a1-1, a2) == (l15,l16) = pierdes
  | (a1-1, a2) == (r1,r2) || (a1-1, a2) == (r3,r4) || (a1-1, a2) == (r5,r6) || (a1-1, a2) == (r7,r8) || (a1-1, a2) == (r9,r10) || (a1-1, a2) == (r11,r12) || (a1-1, a2) == (r13,r14) || (a1-1, a2) == (r15,r16) || (a1-1, a2) == (r17,r18) || (a1-1, a2) == (r19,r20) || (a1-1, a2) == (r21,r22) || (a1-1, a2) == (r23,r24) || (a1-1, a2) == (r25,r26) || (a1-1, a2) == (r27,r28) || (a1-1, a2) == (r29,r30) || (a1-1, a2) == (r31,r32) || (a1-1, a2) == (r33,r34) || (a1-1, a2) == (r35,r36) || (a1-1, a2) == (r37,r38) || (a1-1, a2) == (r39,r40) || (a1-1, a2) == (r41,r42) || (a1-1, a2) == (r43,r44) || (a1-1, a2) == (r45,r46) || (a1-1, a2) == (r47,r48) || (a1-1, a2) == (r49,r50) || (a1-1, a2) == (r51,r52) || (a1-1, a2) == (r53,r54) || (a1-1, a2) == (r55,r56) || (a1-1, a2) == (r57,r58) || (a1-1, a2) == (r59,r60) || (a1-1, a2) == (r61,r62) || (a1-1, a2) == (r63,r64) || (a1-1, a2) == (r65,r66) || (a1-1, a2) == (r67,r68) || (a1-1, a2) == (r69,r70) || (a1-1, a2) == (r71,r72) || (a1-1, a2) == (r73,r74) || (a1-1, a2) == (r75,r76) || (a1-1, a2) == (r77,r78) || (a1-1, a2) == (r79,r80) || (a1-1, a2) == (r81,r82) || (a1-1, a2) == (r83,r84) || (a1-1, a2) == (r85,r86) || (a1-1, a2) == (r87,r88) || (a1-1, a2) == (r89,r90) || (a1-1, a2) == (r91,r92) || (a1-1, a2) == (r93,r94) || (a1-1, a2) == (r95,r96) = pierdes 
  | (a1-1, a2) == (w1,w2) || (a1-1, a2) == (w3,w4) || (a1-1, a2) == (w13,w14) || (a1-1, a2) == (w15,w16) = prisionDeOro
  | ((a1-1, a2) == (i,j)) && (contador == 10) = prisionDeOro 
  | ((a1-1, a2) == (i,j)) && (contador < 10) = (n,m,(unsafePerformIO((randomRIO(-4, 4))::IO Int)),(unsafePerformIO((randomRIO(0, -4))::IO Int)),[(-4,5),(-4,5),(-4,5),(-4,5)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador+1, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | otherwise = (n,m,i,j,[(a1-1, a2),(a1, a2), (b1, b2), (c1, c2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  where
    pierdes = (n,m,0,0,[(-10, 0),(-10, 0), (-10, 0), (-10, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    prisionDeOro = (n,m,0,0,[(11, 0),(11, 0), (11, 0), (11, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])

manejaEvento (KeyPress "Up") (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2),(d1, d2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | (a1, a2+1) == (e1,e2) || (a1, a2+1) == (f1,f2) || (a1, a2+1) == (g1,g2) || (a1, a2+1) == (h1,h2) || (a1, a2+1) == (i1,i2) = pierdes
  | (a1, a2+1) == (l1,l2) || (a1, a2+1) == (l3,l4) || (a1, a2+1) == (l13,l14) || (a1, a2+1) == (l15,l16) = pierdes
  | (a1, a2+1) == (r1,r2) || (a1, a2+1) == (r3,r4) || (a1, a2+1) == (r5,r6) || (a1, a2+1) == (r7,r8) || (a1, a2+1) == (r9,r10) || (a1, a2+1) == (r11,r12) || (a1, a2+1) == (r13,r14) || (a1, a2+1) == (r15,r16) || (a1, a2+1) == (r17,r18) || (a1, a2+1) == (r19,r20) || (a1, a2+1) == (r21,r22) || (a1, a2+1) == (r23,r24) || (a1, a2+1) == (r25,r26) || (a1, a2+1) == (r27,r28) || (a1, a2+1) == (r29,r30) || (a1, a2+1) == (r31,r32) || (a1, a2+1) == (r33,r34) || (a1, a2+1) == (r35,r36) || (a1, a2+1) == (r37,r38) || (a1, a2+1) == (r39,r40) || (a1, a2+1) == (r41,r42) || (a1, a2+1) == (r43,r44) || (a1, a2+1) == (r45,r46) || (a1, a2+1) == (r47,r48) || (a1, a2+1) == (r49,r50) || (a1, a2+1) == (r51,r52) || (a1, a2+1) == (r53,r54) || (a1, a2+1) == (r55,r56) || (a1, a2+1) == (r57,r58) || (a1, a2+1) == (r59,r60) || (a1, a2+1) == (r61,r62) || (a1, a2+1) == (r63,r64) || (a1, a2+1) == (r65,r66) || (a1, a2+1) == (r67,r68) || (a1, a2+1) == (r69,r70) || (a1, a2+1) == (r71,r72) || (a1, a2+1) == (r73,r74) || (a1, a2+1) == (r75,r76) || (a1, a2+1) == (r77,r78) || (a1, a2+1) == (r79,r80) || (a1, a2+1) == (r81,r82) || (a1, a2+1) == (r83,r84) || (a1, a2+1) == (r85,r86) || (a1, a2+1) == (r87,r88) || (a1, a2+1) == (r89,r90) || (a1, a2+1) == (r91,r92) || (a1, a2+1) == (r93,r94) || (a1, a2+1) == (r95,r96) = pierdes 
  | or [(a1, a2+1) == (i,j) | (i,j) <- cs] = prisionDeOro
  | ((a1, a2+1) == (i,j)) && (contador == 10) = prisionDeOro 
  | ((a1, a2+1) == (i,j)) && (contador < 10) = (n,m,(unsafePerformIO((randomRIO(-4, 4))::IO Int)),(unsafePerformIO((randomRIO(0, -4))::IO Int)),[(-4,5),(-4,5),(-4,5),(-4,5)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador+1, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | otherwise = (n,m,i,j,[(a1, a2+1),(a1, a2), (b1, b2), (c1, c2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  where
    pierdes = (n,m,0,0,[(-10, 0),(-10, 0), (-10, 0), (-10, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    prisionDeOro = (n,m,0,0,[(11, 0),(11, 0), (11, 0), (11, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    cs = [(w1,w2),(w3,w4),(w5,w6),(w7,w8),(w9,w10),(w11,w12),(w13,w14),(w15,w16)]

manejaEvento (KeyPress "Down") (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2),(d1, d2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | (a1, a2-1) == (e1,e2) || (a1, a2-1) == (f1,f2) || (a1, a2-1) == (g1,g2) || (a1, a2-1) == (h1,h2) || (a1, a2-1) == (i1,i2) = pierdes
  | (a1, a2-1) == (l1,l2) || (a1, a2-1) == (l3,l4) || (a1, a2-1) == (l13,l14) || (a1, a2-1) == (l15,l16) = pierdes
  | (a1, a2-1) == (r1,r2) || (a1, a2-1) == (r3,r4) || (a1, a2-1) == (r5,r6) || (a1, a2-1) == (r7,r8) || (a1, a2-1) == (r9,r10) || (a1, a2-1) == (r11,r12) || (a1, a2-1) == (r13,r14) || (a1, a2-1) == (r15,r16) || (a1, a2-1) == (r17,r18) || (a1, a2-1) == (r19,r20) || (a1, a2-1) == (r21,r22) || (a1, a2-1) == (r23,r24) || (a1, a2-1) == (r25,r26) || (a1, a2-1) == (r27,r28) || (a1, a2-1) == (r29,r30) || (a1, a2-1) == (r31,r32) || (a1, a2-1) == (r33,r34) || (a1, a2-1) == (r35,r36) || (a1, a2-1) == (r37,r38) || (a1, a2-1) == (r39,r40) || (a1, a2-1) == (r41,r42) || (a1, a2-1) == (r43,r44) || (a1, a2-1) == (r45,r46) || (a1, a2-1) == (r47,r48) || (a1, a2-1) == (r49,r50) || (a1, a2-1) == (r51,r52) || (a1, a2-1) == (r53,r54) || (a1, a2-1) == (r55,r56) || (a1, a2-1) == (r57,r58) || (a1, a2-1) == (r59,r60) || (a1, a2-1) == (r61,r62) || (a1, a2-1) == (r63,r64) || (a1, a2-1) == (r65,r66) || (a1, a2-1) == (r67,r68) || (a1, a2-1) == (r69,r70) || (a1, a2-1) == (r71,r72) || (a1, a2-1) == (r73,r74) || (a1, a2-1) == (r75,r76) || (a1, a2-1) == (r77,r78) || (a1, a2-1) == (r79,r80) || (a1, a2-1) == (r81,r82) || (a1, a2-1) == (r83,r84) || (a1, a2-1) == (r85,r86) || (a1, a2-1) == (r87,r88) || (a1, a2-1) == (r89,r90) || (a1, a2-1) == (r91,r92) || (a1, a2-1) == (r93,r94) || (a1, a2-1) == (r95,r96) = pierdes 
  | (a1, a2-1) == (w1,w2) || (a1, a2-1) == (w3,w4) || (a1, a2-1) == (w13,w14) || (a1, a2-1) == (w15,w16) = prisionDeOro
  | ((a1, a2-1) == (i,j)) && (contador == 10) = prisionDeOro 
  | ((a1, a2-1) == (i,j)) && (contador < 10) = (n,m,(unsafePerformIO((randomRIO(-4, 4))::IO Int)),(unsafePerformIO((randomRIO(0, -4))::IO Int)),[(-4,5),(-4,5),(-4,5),(-4,5)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador+1, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | otherwise = (n,m,i,j,[(a1, a2-1),(a1, a2), (b1, b2), (c1, c2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  where
    pierdes = (n,m,0,0,[(-10, 0),(-10, 0), (-10, 0), (-10, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    prisionDeOro = (n,m,0,0,[(11, 0),(11, 0), (11, 0), (11, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])

manejaEvento (KeyPress "3") (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2),(d1, d2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | (a1+1, a2) == (e1,e2) || (a1+1, a2) == (f1,f2) || (a1+1, a2) == (g1,g2) || (a1+1, a2) == (h1,h2) || (a1+1, a2) == (i1,i2) = pierdes
  | (a1+1, a2) == (r1,r2) || (a1+1, a2) == (r3,r4) || (a1+1, a2) == (r5,r6) || (a1+1, a2) == (r7,r8) || (a1+1, a2) == (r9,r10) || (a1+1, a2) == (r11,r12) || (a1+1, a2) == (r13,r14) || (a1+1, a2) == (r15,r16) || (a1+1, a2) == (r17,r18) || (a1+1, a2) == (r19,r20) || (a1+1, a2) == (r21,r22) || (a1+1, a2) == (r23,r24) || (a1+1, a2) == (r25,r26) || (a1+1, a2) == (r27,r28) || (a1+1, a2) == (r29,r30) || (a1+1, a2) == (r31,r32) || (a1+1, a2) == (r33,r34) || (a1+1, a2) == (r35,r36) || (a1+1, a2) == (r37,r38) || (a1+1, a2) == (r39,r40) || (a1+1, a2) == (r41,r42) || (a1+1, a2) == (r43,r44) || (a1+1, a2) == (r45,r46) || (a1+1, a2) == (r47,r48) || (a1+1, a2) == (r49,r50) || (a1+1, a2) == (r51,r52) || (a1+1, a2) == (r53,r54) || (a1+1, a2) == (r55,r56) || (a1+1, a2) == (r57,r58) || (a1+1, a2) == (r59,r60) || (a1+1, a2) == (r61,r62) || (a1+1, a2) == (r63,r64) || (a1+1, a2) == (r65,r66) || (a1+1, a2) == (r67,r68) || (a1+1, a2) == (r69,r70) || (a1+1, a2) == (r71,r72) || (a1+1, a2) == (r73,r74) || (a1+1, a2) == (r75,r76) || (a1+1, a2) == (r77,r78) || (a1+1, a2) == (r79,r80) || (a1+1, a2) == (r81,r82) || (a1+1, a2) == (r83,r84) || (a1+1, a2) == (r85,r86) || (a1+1, a2) == (r87,r88) || (a1+1, a2) == (r89,r90) || (a1+1, a2) == (r91,r92) || (a1+1, a2) == (r93,r94) || (a1+1, a2) == (r95,r96) = pierdes 
  | (a1+1, a2) == (l1,l2) || (a1+1, a2) == (l3,l4) || (a1+1, a2) == (l13,l14) || (a1+1, a2) == (l15,l16) = pierdes
  | (a1+1, a2) == (w1,w2) || (a1+1, a2) == (w3,w4) || (a1+1, a2) == (w13,w14) || (a1+1, a2) == (w15,w16) = prisionDeOro
  | ((a1+1, a2) == (i,j)) && (contador == 10) = prisionDeOro 
  | ((a1+1, a2) == (i,j)) && (contador < 10) = (n,m,(unsafePerformIO((randomRIO(-4, 4))::IO Int)),(unsafePerformIO((randomRIO(0, -4))::IO Int)),[(-4,5),(-4,5),(-4,5),(-4,5)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador+1, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | otherwise = (n,m,i,j,[(a1+1, a2),(a1, a2), (b1, b2), (c1, c2)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  where
    pierdes = (n,m,0,0,[(-10, 0),(-10, 0), (-10, 0), (-10, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    prisionDeOro = (n,m,0,0,[(11, 0),(11, 0), (11, 0), (11, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])

manejaEvento (KeyPress "1") (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2),(d1, d2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | (a1-1, a2) == (e1,e2) || (a1-1, a2) == (f1,f2) || (a1-1, a2) == (g1,g2) || (a1-1, a2) == (h1,h2) || (a1-1, a2) == (i1,i2) = pierdes
  | (a1-1, a2) == (l1,l2) || (a1-1, a2) == (l3,l4) || (a1-1, a2) == (l13,l14) || (a1-1, a2) == (l15,l16) = pierdes
  | (a1-1, a2) == (r1,r2) || (a1-1, a2) == (r3,r4) || (a1-1, a2) == (r5,r6) || (a1-1, a2) == (r7,r8) || (a1-1, a2) == (r9,r10) || (a1-1, a2) == (r11,r12) || (a1-1, a2) == (r13,r14) || (a1-1, a2) == (r15,r16) || (a1-1, a2) == (r17,r18) || (a1-1, a2) == (r19,r20) || (a1-1, a2) == (r21,r22) || (a1-1, a2) == (r23,r24) || (a1-1, a2) == (r25,r26) || (a1-1, a2) == (r27,r28) || (a1-1, a2) == (r29,r30) || (a1-1, a2) == (r31,r32) || (a1-1, a2) == (r33,r34) || (a1-1, a2) == (r35,r36) || (a1-1, a2) == (r37,r38) || (a1-1, a2) == (r39,r40) || (a1-1, a2) == (r41,r42) || (a1-1, a2) == (r43,r44) || (a1-1, a2) == (r45,r46) || (a1-1, a2) == (r47,r48) || (a1-1, a2) == (r49,r50) || (a1-1, a2) == (r51,r52) || (a1-1, a2) == (r53,r54) || (a1-1, a2) == (r55,r56) || (a1-1, a2) == (r57,r58) || (a1-1, a2) == (r59,r60) || (a1-1, a2) == (r61,r62) || (a1-1, a2) == (r63,r64) || (a1-1, a2) == (r65,r66) || (a1-1, a2) == (r67,r68) || (a1-1, a2) == (r69,r70) || (a1-1, a2) == (r71,r72) || (a1-1, a2) == (r73,r74) || (a1-1, a2) == (r75,r76) || (a1-1, a2) == (r77,r78) || (a1-1, a2) == (r79,r80) || (a1-1, a2) == (r81,r82) || (a1-1, a2) == (r83,r84) || (a1-1, a2) == (r85,r86) || (a1-1, a2) == (r87,r88) || (a1-1, a2) == (r89,r90) || (a1-1, a2) == (r91,r92) || (a1-1, a2) == (r93,r94) || (a1-1, a2) == (r95,r96) = pierdes 
  | (a1-1, a2) == (w1,w2) || (a1-1, a2) == (w3,w4) || (a1-1, a2) == (w13,w14) || (a1-1, a2) == (w15,w16) = pierdes
  | ((a1-1, a2) == (i,j)) && (contador == 10) = prisionDeOro 
  | ((a1-1, a2) == (i,j)) && (contador < 10) = (n,m,(unsafePerformIO((randomRIO(-4, 4))::IO Int)),(unsafePerformIO((randomRIO(0, -4))::IO Int)),[(-4,5),(-4,5),(-4,5),(-4,5)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador+1, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | otherwise = (n,m,i,j,[(a1-1, a2),(a1, a2), (b1, b2), (c1, c2)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  where
    pierdes = (n,m,0,0,[(-10, 0),(-10, 0), (-10, 0), (-10, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    prisionDeOro = (n,m,0,0,[(11, 0),(11, 0), (11, 0), (11, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])

manejaEvento (KeyPress "5") (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2),(d1, d2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | (a1, a2+1) == (e1,e2) || (a1, a2+1) == (f1,f2) || (a1, a2+1) == (g1,g2) || (a1, a2+1) == (h1,h2) || (a1, a2+1) == (i1,i2) = pierdes
  | (a1, a2+1) == (l1,l2) || (a1, a2+1) == (l3,l4) || (a1, a2+1) == (l13,l14) || (a1, a2+1) == (l15,l16) = pierdes
  | (a1, a2+1) == (r1,r2) || (a1, a2+1) == (r3,r4) || (a1, a2+1) == (r5,r6) || (a1, a2+1) == (r7,r8) || (a1, a2+1) == (r9,r10) || (a1, a2+1) == (r11,r12) || (a1, a2+1) == (r13,r14) || (a1, a2+1) == (r15,r16) || (a1, a2+1) == (r17,r18) || (a1, a2+1) == (r19,r20) || (a1, a2+1) == (r21,r22) || (a1, a2+1) == (r23,r24) || (a1, a2+1) == (r25,r26) || (a1, a2+1) == (r27,r28) || (a1, a2+1) == (r29,r30) || (a1, a2+1) == (r31,r32) || (a1, a2+1) == (r33,r34) || (a1, a2+1) == (r35,r36) || (a1, a2+1) == (r37,r38) || (a1, a2+1) == (r39,r40) || (a1, a2+1) == (r41,r42) || (a1, a2+1) == (r43,r44) || (a1, a2+1) == (r45,r46) || (a1, a2+1) == (r47,r48) || (a1, a2+1) == (r49,r50) || (a1, a2+1) == (r51,r52) || (a1, a2+1) == (r53,r54) || (a1, a2+1) == (r55,r56) || (a1, a2+1) == (r57,r58) || (a1, a2+1) == (r59,r60) || (a1, a2+1) == (r61,r62) || (a1, a2+1) == (r63,r64) || (a1, a2+1) == (r65,r66) || (a1, a2+1) == (r67,r68) || (a1, a2+1) == (r69,r70) || (a1, a2+1) == (r71,r72) || (a1, a2+1) == (r73,r74) || (a1, a2+1) == (r75,r76) || (a1, a2+1) == (r77,r78) || (a1, a2+1) == (r79,r80) || (a1, a2+1) == (r81,r82) || (a1, a2+1) == (r83,r84) || (a1, a2+1) == (r85,r86) || (a1, a2+1) == (r87,r88) || (a1, a2+1) == (r89,r90) || (a1, a2+1) == (r91,r92) || (a1, a2+1) == (r93,r94) || (a1, a2+1) == (r95,r96) = pierdes 
  | or [(a1, a2+1) == (i,j) | (i,j) <- cs] = prisionDeOro
  | ((a1, a2+1) == (i,j)) && (contador == 10) = prisionDeOro 
  | ((a1, a2+1) == (i,j)) && (contador < 10) = (n,m,(unsafePerformIO((randomRIO(-4, 4))::IO Int)),(unsafePerformIO((randomRIO(0, -4))::IO Int)),[(-4,5),(-4,5),(-4,5),(-4,5)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador+1, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | otherwise = (n,m,i,j,[(a1, a2+1),(a1, a2), (b1, b2), (c1, c2)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  where
    pierdes = (n,m,0,0,[(-10, 0),(-10, 0), (-10, 0), (-10, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    prisionDeOro = (n,m,0,0,[(11, 0),(11, 0), (11, 0), (11, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    cs = [(w1,w2),(w3,w4),(w5,w6),(w7,w8),(w9,w10),(w11,w12),(w13,w14),(w15,w16)]

manejaEvento (KeyPress "2") (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2),(d1, d2)],((e1, e2),(f1, f2), (g1, g2), (h1, h2), (i1, i2)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | (a1, a2-1) == (e1,e2) || (a1, a2-1) == (f1,f2) || (a1, a2-1) == (g1,g2) || (a1, a2-1) == (h1,h2) || (a1, a2-1) == (i1,i2) = pierdes
  | (a1, a2-1) == (l1,l2) || (a1, a2-1) == (l3,l4) || (a1, a2-1) == (l13,l14) || (a1, a2-1) == (l15,l16) = pierdes
  | (a1, a2-1) == (r1,r2) || (a1, a2-1) == (r3,r4) || (a1, a2-1) == (r5,r6) || (a1, a2-1) == (r7,r8) || (a1, a2-1) == (r9,r10) || (a1, a2-1) == (r11,r12) || (a1, a2-1) == (r13,r14) || (a1, a2-1) == (r15,r16) || (a1, a2-1) == (r17,r18) || (a1, a2-1) == (r19,r20) || (a1, a2-1) == (r21,r22) || (a1, a2-1) == (r23,r24) || (a1, a2-1) == (r25,r26) || (a1, a2-1) == (r27,r28) || (a1, a2-1) == (r29,r30) || (a1, a2-1) == (r31,r32) || (a1, a2-1) == (r33,r34) || (a1, a2-1) == (r35,r36) || (a1, a2-1) == (r37,r38) || (a1, a2-1) == (r39,r40) || (a1, a2-1) == (r41,r42) || (a1, a2-1) == (r43,r44) || (a1, a2-1) == (r45,r46) || (a1, a2-1) == (r47,r48) || (a1, a2-1) == (r49,r50) || (a1, a2-1) == (r51,r52) || (a1, a2-1) == (r53,r54) || (a1, a2-1) == (r55,r56) || (a1, a2-1) == (r57,r58) || (a1, a2-1) == (r59,r60) || (a1, a2-1) == (r61,r62) || (a1, a2-1) == (r63,r64) || (a1, a2-1) == (r65,r66) || (a1, a2-1) == (r67,r68) || (a1, a2-1) == (r69,r70) || (a1, a2-1) == (r71,r72) || (a1, a2-1) == (r73,r74) || (a1, a2-1) == (r75,r76) || (a1, a2-1) == (r77,r78) || (a1, a2-1) == (r79,r80) || (a1, a2-1) == (r81,r82) || (a1, a2-1) == (r83,r84) || (a1, a2-1) == (r85,r86) || (a1, a2-1) == (r87,r88) || (a1, a2-1) == (r89,r90) || (a1, a2-1) == (r91,r92) || (a1, a2-1) == (r93,r94) || (a1, a2-1) == (r95,r96) = pierdes 
  | (a1, a2-1) == (w1,w2) || (a1, a2-1) == (w3,w4) || (a1, a2-1) == (w13,w14) || (a1, a2-1) == (w15,w16) = prisionDeOro
  | ((a1, a2-1) == (i,j)) && (contador == 10) = prisionDeOro 
  | ((a1, a2-1) == (i,j)) && (contador < 10) = (n,m,(unsafePerformIO((randomRIO(-4, 4))::IO Int)),(unsafePerformIO((randomRIO(0, -4))::IO Int)),[(-4,5),(-4,5),(-4,5),(-4,5)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)],marcador, contador+1, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  | otherwise = (n,m,i,j,[(a1, a2-1),(a1, a2), (b1, b2), (c1, c2)],(((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int))), ((unsafePerformIO((randomRIO(-3, 5))::IO Int)), (unsafePerformIO((randomRIO(1, 5))::IO Int)))), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
  where
    pierdes = (n,m,0,0,[(-10, 0),(-10, 0), (-10, 0), (-10, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])
    prisionDeOro = (n,m,0,0,[(11, 0),(11, 0), (11, 0), (11, 0)],((0, 0),(0, 0), (0, 0), (0, 0), (0, 0)), [(r1,r2),(r3,r4),(r5,r6),(r7,r8),(r9,r10),(r11,r12),(r13,r14),(r15,r16),(r17,r18),(r19,r20),(r21,r22),(r23,r24),(r25,r26),(r27,r28),(r29,r30),(r31,r32),(r33,r34),(r35,r36),(r37,r38),(r39,r40),(r41,r42),(r43,r44),(r45,r46),(r47,r48),(r49,r50),(r51,r52),(r53,r54),(r55,r56),(r57,r58),(r59,r60),(r61,r62),(r63,r64),(r65,r66),(r67,r68),(r69,r70),(r71,r72),(r73,r74),(r75,r76),(r77,r78),(r79,r80),(r81,r82),(r83,r84),(r85,r86),(r87,r88),(r89,r90),(r91,r92),(r93,r94),(r95,r96)], [(l1,l2), (l3, l4), (l5,l6), (l7,l8), (l9,l10), (l11,l12), (l13,l14),(l15,l16)], marcador, contador, [(w1,w2), (w3, w4), (w5,w6), (w7,w8), (w9,w10), (w11,w12), (w13,w14),(w15,w16)])


manejaEvento _ (n,m,i,j,[(a1, a2),(b1, b2),(c1, c2), (d1, d2)],xs , xp, lol, marcador, contador, muro) = (n,m,i,j,[(a1, a2),(b1, b2), (c1, c2), (d1, d2)],xs, xp, lol, marcador, contador, muro)

pintaEstadoConFondo :: Estado -> Picture
pintaEstadoConFondo (n,m,i,j,rs, xs, xp, lol, marcador, contador, muro) = pintaCarcelGanador muro & pintaTextoMarcador2 & pintaTextoMarcador & pintaMarcador marcador contador & pintaCarcel3 lol & pintaTexto & (pintaNegro n m) & pintaBloqueInter xs & pintaBloqueBorde xp &pintaSerpiente rs & (pintaManzana (i, j)) 


pintaTexto = pintaTitulo & pintaSubtitulo & pintaSubtitulo2 & pintaSubtitulo3 & texto4 & texto5 & texto6 & texto7
pintaTitulo = (translated x y (scaled 0.5 0.5 (lettering("  Llega al circulo rojo tantas veces como puedas"))))
  where x = fromIntegral (0)
        y = fromIntegral (-6)

pintaTextoMarcador = (translated x y (scaled 0.5 0.5 (lettering(" Marcador"))))
  where x = fromIntegral (0)
        y = fromIntegral (9)

pintaTextoMarcador2 = (translated x y (scaled 0.4 0.4 (lettering(" (Puntuación máxima 10)"))))
  where x = fromIntegral (0)
        y = 7.4

pintaSubtitulo = (translated x (-6.5) (scaled 0.5 0.5 (lettering("  Si tocas un muro, pierdes"))))
  where x = fromIntegral (0)
pintaSubtitulo2 = (translated x (-7.0) (scaled 0.5 0.5 (lettering("Nivel fácil: Controla la serpiente con ←, → ↓ ↑"))))
  where x = fromIntegral (0)
pintaSubtitulo3 = (translated x (-7.5) (scaled 0.5 0.5 (lettering("Nivel dificil: Controla la serpiente con 1, 3, 2, 5"))))
  where x = fromIntegral (0)
texto4 = (translated (-10.0) (-1.75) (scaled 0.5 0.5 (colored red(lettering("Si estas aquí has perdido")))))
texto5 = (translated (-10.0) (-2.25) (scaled 0.5 0.5 (colored red(lettering("Para volver a jugar, recargar página")))))

texto6 = (translated (11.0) (-1.75) (scaled 0.5 0.5 (colored orange(lettering("Si estas aquí has ganado")))))
texto7 = (translated (11.0) (-2.25) (scaled 0.5 0.5 (colored orange(lettering("Para volver a jugar, recargar página")))))
